# ğŸ”§ GitHub CI/CD Setup

## Ğ‘Ñ‹ÑÑ‚Ñ€Ğ°Ñ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ°

### 1. Ğ”Ğ¾Ğ±Ğ°Ğ²ÑŒ GitHub Secrets

ĞŸĞµÑ€ĞµĞ¹Ğ´Ğ¸: **Settings â†’ Secrets and variables â†’ Actions â†’ New repository secret**

| Secret Name | Value |
|-------------|-------|
| `SERVER_URL` | `http://138.124.0.8` |
| `CI_API_KEY` | `gh-actions-secret-key-12345` |

### 2. Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾!

Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Ğ¿Ñ€Ğ¸ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¼ Ğ¿ÑƒÑˆĞµ:
- `externa/**` â†’ Ğ±Ğ¸Ğ»Ğ´Ğ¸Ñ‚ÑÑ External Ñ‡Ğ¸Ñ‚ â†’ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµÑ‚ÑÑ Ğ½Ğ° ÑĞµÑ€Ğ²ĞµÑ€
- `launcher-server/launcher/**` â†’ Ğ±Ğ¸Ğ»Ğ´Ğ¸Ñ‚ÑÑ Launcher â†’ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµÑ‚ÑÑ Ğ½Ğ° ÑĞµÑ€Ğ²ĞµÑ€

---

## ĞšĞ°Ğº ÑÑ‚Ğ¾ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  git push   â”‚â”€â”€â”€â”€â–¶â”‚   GitHub    â”‚â”€â”€â”€â”€â–¶â”‚   Server    â”‚
â”‚             â”‚     â”‚   Actions   â”‚     â”‚  (Ñ„Ğ°Ğ¹Ğ»Ñ‹)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Artifacts  â”‚
                    â”‚  (backup)   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Workflow Ñ„Ğ°Ğ¹Ğ»Ñ‹:

| Ğ¤Ğ°Ğ¹Ğ» | Ğ¢Ñ€Ğ¸Ğ³Ğ³ĞµÑ€ | Ğ§Ñ‚Ğ¾ Ğ´ĞµĞ»Ğ°ĞµÑ‚ |
|------|---------|------------|
| `build.yml` | `externa/**` | Ğ‘Ğ¸Ğ»Ğ´Ğ¸Ñ‚ External ESP |
| `launcher.yml` | `launcher-server/launcher/**` | Ğ‘Ğ¸Ğ»Ğ´Ğ¸Ñ‚ Launcher |
| `internal.yml` | `internal/**` | Ğ‘Ğ¸Ğ»Ğ´Ğ¸Ñ‚ Internal DLL |
| `deploy.yml` | Ğ’Ñ€ÑƒÑ‡Ğ½ÑƒÑ | Ğ”ĞµĞ¿Ğ»Ğ¾Ğ¸Ñ‚ ÑĞµÑ€Ğ²ĞµÑ€ |

---

## Ğ ÑƒÑ‡Ğ½Ğ¾Ğ¹ Ğ·Ğ°Ğ¿ÑƒÑĞº

1. ĞŸĞµÑ€ĞµĞ¹Ğ´Ğ¸ Ğ² **Actions**
2. Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸ workflow
3. ĞĞ°Ğ¶Ğ¼Ğ¸ **Run workflow**
4. Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸ branch `main`
5. ĞĞ°Ğ¶Ğ¼Ğ¸ **Run workflow**

---

## ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸

ĞŸĞ¾ÑĞ»Ğµ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾Ğ³Ğ¾ Ğ±Ğ¸Ğ»Ğ´Ğ° Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑŒ Ğ½Ğ° ÑĞµÑ€Ğ²ĞµÑ€Ğµ:

```bash
# SSH Ğ½Ğ° ÑĞµÑ€Ğ²ĞµÑ€
ssh root@138.124.0.8

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ Ñ„Ğ°Ğ¹Ğ»Ñ‹
ls -la /root/cs-legit/launcher-server/storage/files/cs2/
ls -la /root/cs-legit/launcher-server/storage/files/launcher/
```

Ğ˜Ğ»Ğ¸ Ñ‡ĞµÑ€ĞµĞ· API:

```bash
curl http://138.124.0.8/api/games
```

---

## Troubleshooting

### âŒ "Upload failed"

1. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ Ñ‡Ñ‚Ğ¾ secrets Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½Ñ‹
2. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ Ñ‡Ñ‚Ğ¾ ÑĞµÑ€Ğ²ĞµÑ€ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½: `curl http://138.124.0.8/health`
3. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ Ğ»Ğ¾Ğ³Ğ¸ ÑĞµÑ€Ğ²ĞµÑ€Ğ°: `ssh root@138.124.0.8 journalctl -u launcher -n 50`

### âŒ "Build failed"

1. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ Ğ²ĞºĞ»Ğ°Ğ´ĞºÑƒ Actions Ğ½Ğ° GitHub
2. ĞšĞ»Ğ¸ĞºĞ½Ğ¸ Ğ½Ğ° failed job
3. ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€Ğ¸ Ğ»Ğ¾Ğ³Ğ¸

### âŒ "Secrets not found"

1. Ğ£Ğ±ĞµĞ´Ğ¸ÑÑŒ Ñ‡Ñ‚Ğ¾ secrets Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ñ‹ Ğ² **Settings â†’ Secrets â†’ Actions**
2. ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ñ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ğ±Ñ‹Ñ‚ÑŒ Ñ‚Ğ¾Ñ‡Ğ½Ğ¾: `SERVER_URL` Ğ¸ `CI_API_KEY`

---

## Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ

- CI_API_KEY Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑÑ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ² GitHub Secrets (Ğ·Ğ°ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½)
- Ğ¡ĞµÑ€Ğ²ĞµÑ€ Ğ¿Ñ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¼ ĞºĞ»ÑÑ‡Ğ¾Ğ¼
- Ğ¤Ğ°Ğ¹Ğ»Ñ‹ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ÑÑ‚ÑÑ Ğ² Ğ¸Ğ·Ğ¾Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½ÑƒÑ Ğ¿Ğ°Ğ¿ĞºÑƒ
- Ğ’ÑĞµ Ğ±Ğ¸Ğ»Ğ´Ñ‹ Ğ»Ğ¾Ğ³Ğ¸Ñ€ÑƒÑÑ‚ÑÑ

---

## Ğ’ĞµÑ€ÑĞ¸Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

Ğ’ĞµÑ€ÑĞ¸Ğ¸ Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒÑÑ‚ÑÑ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸:
- External: `1.0.{run_number}` (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€ `1.0.42`)
- Launcher: `2.0.{run_number}` (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€ `2.0.15`)

ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ±Ğ¸Ğ»Ğ´ ÑĞ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ `version.json`:
```json
{
  "version": "1.0.42",
  "build": 42,
  "commit": "abc123...",
  "date": "2025-12-23 12:00:00"
}
```
