# üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Hypervisor Cheat

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. **–í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞** (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)
   - VMware Workstation Pro (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
   - VirtualBox
   - QEMU/KVM

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ VM**
   - –í–∫–ª—é—á–∏—Ç—å Nested Virtualization
   - UEFI mode (–Ω–µ Legacy BIOS)
   - –ú–∏–Ω–∏–º—É–º 4GB RAM
   - Windows 10/11 x64

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ VMware

```
1. –í—ã–∫–ª—é—á–∏—Ç—å VM
2. –û—Ç–∫—Ä—ã—Ç—å .vmx —Ñ–∞–π–ª
3. –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫–∏:
   vhv.enable = "TRUE"
   vpmc.enable = "TRUE"
   hypervisor.cpuid.v0 = "FALSE"
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ VirtualBox

```bash
VBoxManage modifyvm "VM_NAME" --nested-hw-virt on
VBoxManage modifyvm "VM_NAME" --firmware efi
```

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### 1. Usermode Overlay

–≠—Ç–æ —Å–∞–º—ã–π –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç - —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –æ–±—ã—á–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

```bash
# –°–æ–±—Ä–∞—Ç—å
cd hypervisor-cheat
cmake -B build -G "Visual Studio 17 2022" -A x64
cmake --build build --config Release

# –ó–∞–ø—É—Å—Ç–∏—Ç—å
./build/bin/Release/hypervisor_overlay.exe
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- [ ] Overlay —Å–æ–∑–¥–∞—ë—Ç—Å—è
- [ ] DirectX –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è
- [ ] –û–∫–Ω–æ —Å–ª–µ–¥—É–µ—Ç –∑–∞ CS2
- [ ] –ú–µ–Ω—é –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è (INSERT)

**–ë–µ–∑ hypervisor:**
- Overlay –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è, –Ω–æ –ø–æ–∫–∞–∂–µ—Ç –æ—à–∏–±–∫—É "Hypervisor not active"
- –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ - –Ω—É–∂–µ–Ω bootkit

### 2. Bootkit (Ring -3)

‚ö†Ô∏è **–¢–û–õ–¨–ö–û –í VM!**

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ VM

```powershell
# 1. –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å ESP —Ä–∞–∑–¥–µ–ª
mountvol X: /s

# 2. –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
mkdir X:\EFI\Boot\Drivers

# 3. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å EFI
copy HypervisorBootkit.efi X:\EFI\Boot\Drivers\

# 4. –î–æ–±–∞–≤–∏—Ç—å –≤ –∑–∞–≥—Ä—É–∑–∫—É
bcdedit /set {bootmgr} path \EFI\Boot\Drivers\HypervisorBootkit.efi
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ UEFI Shell

```
# –ó–∞–≥—Ä—É–∑–∏—Ç—å—Å—è –≤ UEFI Shell
# –ù–∞–π—Ç–∏ EFI:
fs0:
ls EFI\Boot\Drivers\

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é:
load HypervisorBootkit.efi
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- [ ] Bootkit –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
- [ ] –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –±–∞–Ω–Ω–µ—Ä
- [ ] –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç VM
- [ ] –•—É–∫–∞–µ—Ç ExitBootServices
- [ ] Windows –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ

### 3. –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª

```
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å bootkit
2. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å VM
3. Bootkit –∑–∞–≥—Ä—É–∑–∏—Ç hypervisor
4. Windows –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∫–∞–∫ –≥–æ—Å—Ç—å
5. –ó–∞–ø—É—Å—Ç–∏—Ç—å overlay
6. Overlay –ø–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ hypervisor
7. –ó–∞–ø—É—Å—Ç–∏—Ç—å CS2
8. ESP —Ä–∞–±–æ—Ç–∞–µ—Ç!
```

---

## –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

| –¢–µ—Å—Ç | –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç |
|------|---------------------|
| –ó–∞–ø—É—Å–∫ –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º –∂–µ–ª–µ–∑–µ | –û—Ç–∫–∞–∑ —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º "Not VM" |
| 3+ –æ—à–∏–±–∫–∏ –ø–æ–¥—Ä—è–¥ | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–∫–∞—Ç |
| DRY_RUN_MODE | –¢–æ–ª—å–∫–æ –ª–æ–≥–∏, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π |
| –ù–µ–≤–µ—Ä–Ω—ã–π —É–∫–∞–∑–∞—Ç–µ–ª—å | –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç–∫–ª–æ–Ω–∏—Ç |

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–∞–º—è—Ç—å

| –¢–µ—Å—Ç | –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç |
|------|---------------------|
| –ß—Ç–µ–Ω–∏–µ client.dll | –£—Å–ø–µ—Ö |
| –ß—Ç–µ–Ω–∏–µ entity list | –£—Å–ø–µ—Ö |
| –ß—Ç–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π –∏–≥—Ä–æ–∫–æ–≤ | –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ |
| –ß—Ç–µ–Ω–∏–µ –Ω–µ–≤–µ—Ä–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞ | –û—à–∏–±–∫–∞ (–Ω–µ –∫—Ä—ç—à) |

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: ESP

| –¢–µ—Å—Ç | –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç |
|------|---------------------|
| –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–æ–∫—Å–æ–≤ | –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ |
| –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è | 0-100% |
| –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–º—ë–Ω | –ß–∏—Ç–∞–µ–º—ã–µ |
| –§–∏–ª—å—Ç—Ä –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏ | –†–∞–±–æ—Ç–∞–µ—Ç |

---

## –û—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏ Bootkit

–í UEFI –Ω–µ—Ç —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –ª–æ–≥–æ–≤. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

1. **–°–µ—Ä–∏–π–Ω—ã–π –ø–æ—Ä—Ç** (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
2. **EFI Print** (–Ω–∞ —ç–∫—Ä–∞–Ω–µ)
3. **Debug buffer** (–¥–ª—è –æ—Ç–ª–∞–¥—á–∏–∫–∞)

### –õ–æ–≥–∏ Hypervisor

```c
// –í–∫–ª—é—á–∏—Ç—å –≤ safety.h
#define ENABLE_LOGGING 1

// –õ–æ–≥–∏ –∏–¥—É—Ç –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –ø–æ—Ä—Ç
SafetyLog(LOG_INFO, "Message...");
```

### –õ–æ–≥–∏ Overlay

```cpp
std::cout << "[HV] Message" << std::endl;
```

---

## –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### "Hypervisor not active"

**–ü—Ä–∏—á–∏–Ω—ã:**
1. Bootkit –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
2. Bootkit –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è
3. Hypervisor –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª—Å—è
4. –î—Ä—É–≥–æ–π hypervisor —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É bootkit
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å UEFI boot order
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ bootkit
4. –û—Ç–∫–ª—é—á–∏—Ç—å Hyper-V –≤ Windows

### BSOD –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ

**–ü—Ä–∏—á–∏–Ω—ã:**
1. –û—à–∏–±–∫–∞ –≤ hypervisor
2. –ö–æ–Ω—Ñ–ª–∏–∫—Ç —Å Windows
3. –ù–µ–≤–µ—Ä–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ EPT

**–†–µ—à–µ–Ω–∏–µ:**
1. Boot –≤ Safe Mode (–¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å)
2. –£–¥–∞–ª–∏—Ç—å bootkit
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏

### ESP –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω—ã:**
1. CS2 –Ω–µ –Ω–∞–π–¥–µ–Ω
2. –ù–µ–≤–µ—Ä–Ω—ã–µ –æ—Ñ—Ñ—Å–µ—Ç—ã
3. DirectX –æ—à–∏–±–∫–∞

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ CS2 –∑–∞–ø—É—â–µ–Ω
2. –û–±–Ω–æ–≤–∏—Ç—å –æ—Ñ—Ñ—Å–µ—Ç—ã
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é DirectX

---

## –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

| –û–ø–µ—Ä–∞—Ü–∏—è | –¶–µ–ª–µ–≤–æ–µ –≤—Ä–µ–º—è |
|----------|---------------|
| VMCALL ping | < 1Œºs |
| –ß—Ç–µ–Ω–∏–µ 4 –±–∞–π—Ç | < 5Œºs |
| –ß—Ç–µ–Ω–∏–µ entity (–ø–æ–ª–Ω—ã–π) | < 50Œºs |
| Full game update | < 1ms |
| Frame render | < 16ms (60 FPS) |

---

## Checklist –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º

- [ ] –°–æ–∑–¥–∞–Ω —Å–Ω–∞–ø—à–æ—Ç VM
- [ ] VM_ONLY_MODE = 1
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ
- [ ] Windows –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ Safe Mode
- [ ] –ï—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ UEFI Shell
- [ ] Bootkit backup —Å–æ—Ö—Ä–∞–Ω—ë–Ω

